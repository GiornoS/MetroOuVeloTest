angular.module("starter",["ionic","ngCordova"]).run(function(a){a.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault()})}),angular.module("carte",["ionic","ngCordova"]).controller("DirectionCtrl",function(a,b,c,d){function e(){var b=new google.maps.LatLng(48.85834,2.33752),c={center:b,zoom:11,mapTypeId:google.maps.MapTypeId.ROADMAP},d=new google.maps.Map(document.getElementById("map"),c);f.setMap(d),a.map=d}var f=new google.maps.DirectionsRenderer;ionic.Platform.ready(e);var g;a.centerOnMe=function(){a.show_donnees_du_trajet=!1,a.map&&(a.loading=b.show({template:"Recherche de la position en cours...",showBackdrop:!1}),navigator.geolocation.getCurrentPosition(function(d){a.map.setCenter(new google.maps.LatLng(d.coords.latitude,d.coords.longitude)),a.map.setZoom(15),b.hide();var e=new google.maps.LatLng(d.coords.latitude,d.coords.longitude);g?(g.setMap(null),g=new google.maps.Marker({position:e,map:a.map,title:"You are here"})):g=new google.maps.Marker({position:e,map:a.map,title:"You are here"}),c.get("http://maps.googleapis.com/maps/api/geocode/json?latlng="+d.coords.latitude+","+d.coords.longitude+"&sensor=false").success(function(b){a.city_start=b.results[0].formatted_address,a.address_autocomplete1=b.results[0].formatted_address}).error(function(){alert("Impossible de récupérer la géolocalisation")})},function(a){alert("Unable to get location: "+a.message),b.hide()},{timeout:15e3}))},a.showCard=function(){a.show_card_definir_un_trajet=1==a.show_card_definir_un_trajet?!1:!0},a.calculate=function(e,g,k,l){if(e&&g){d.trackEvent("city_end","click","Adresse Saisie"),a.loading=b.show({template:"Calcul du trajet en cours...",showBackdrop:!1}),c.get("http://maps.googleapis.com/maps/api/geocode/json?address="+e+"&language=fr&&sensor=false").success(function(b){a.city_start=b.results[0].formatted_address}).error(function(){alert("Impossible de récupérer la géolocalisation")}),c.get("http://maps.googleapis.com/maps/api/geocode/json?address="+g+"&language=fr&&sensor=false").success(function(b){a.city_end=b.results[0].formatted_address}).error(function(){alert("Impossible de récupérer la géolocalisation")});var m=h.getMonth().toString(),n=h.getDate().toString(),o=h.getFullYear().toString();if(k&&l)var p=l.replace("h",""),q=k.replace("min","");else if(k)var p=i,q=k.replace("min","");else if(l)var p=l.replace("h",""),q=j;else var p=i,q=j;var r=m+"/"+n+"/"+o+" "+p+":"+q;millisecondes_unix=Date.parse(r);var s={origin:e,destination:g,transitOptions:{departureTime:new Date(millisecondes_unix)},travelMode:google.maps.DirectionsTravelMode.BICYCLING,unitSystem:google.maps.UnitSystem.METRIC},t=new google.maps.DirectionsService;t.route(s,function(c,d){d==google.maps.DirectionsStatus.OK&&(b.hide(),a.showCard(),f.setDirections(c),a.donnees_du_trajet=c,a.show_donnees_du_trajet=!0)})}},a.initializeAutocomplete=function(b,c){var d=document.getElementById(b),e=document.getElementById(c);if(d&&e){var f=new google.maps.places.Autocomplete(d),g=new google.maps.places.Autocomplete(e);google.maps.event.addListener(f,"place_changed",function(){var b=this.getPlace();b.address_components&&(a.address_autocomplete1=b.address_components[0].short_name+" "+b.address_components[1].short_name+" "+b.address_components[2].short_name)}),google.maps.event.addListener(g,"place_changed",function(){var b=this.getPlace();b.address_components&&(a.address_autocomplete2=b.address_components[0].short_name+" "+b.address_components[1].short_name+" "+b.address_components[2].short_name)})}},a.initializeAutocomplete("city_start","city_end");var h=new Date,i=h.getHours(),j=h.getMinutes();a.heure_actuelle=i.toString()+"h",a.minute_actuelle=j.toString()+"min",document.addEventListener("deviceready",function(){function a(){"undefined"!=typeof analytics?d.trackView("Définition du trajet"):setTimeout(function(){a()},250)}a()},!1)}),angular.module("app",["ionic","ngCordova"]).controller("WeatherCtrl",function(a,b,c,d,e,f){var g="1706cc9340ee8e2c6c2fecd7b9dc5a1c";a.searchWeather=function(d){e.trackEvent("city","click","Adresse Saisie"),a.loading=c.show({template:"Récupération des données météorologiques...",showBackdrop:!1});var f="http://maps.googleapis.com/maps/api/geocode/json?address="+d+"&language=fr&&sensor=false";b.get(f).success(httpSuccessGetCoordonates).error(httpError)},httpSuccessGetCoordonates=function(c){a.coordonates=c;var d="https://api.forecast.io/forecast/"+g+"/"+a.coordonates.results[0].geometry.location.lat+","+a.coordonates.results[0].geometry.location.lng+"?units=si";b.get(d).success(httpSuccessSearchWeather).error(httpError)},httpSuccessSearchWeather=function(b){a.weather=b,c.hide()};var h={timeout:1e4,enableHighAccuracy:!1};a.geolocate=function(){a.loading=c.show({template:"Récupération des données météorologiques...",showBackdrop:!1}),f.getCurrentPosition(h).then(function(a){b.get("https://api.forecast.io/forecast/"+g+"/"+a.coords.latitude+","+a.coords.longitude+"?units=si").success(httpSuccessGeolocate).error(httpError)},function(){alert("Erreur : impossible de vous géolocaliser"),c.hide()})},httpSuccessGeolocate=function(c){a.weather=c,navigator.geolocation.getCurrentPosition(function(a){b.get("http://maps.googleapis.com/maps/api/geocode/json?latlng="+a.coords.latitude+","+a.coords.longitude+"&sensor=false").success(httpSuccessGeolocateSuccess).error(httpError)})},httpSuccessGeolocateSuccess=function(b){a.coordonates=b,a.city=b.results[0].formatted_address,c.hide()},httpError=function(){c.hide(),alert("Impossible de récupérer les informations")},a.initializeAutocomplete=function(b){var c=document.getElementById(b);if(c){var d=new google.maps.places.Autocomplete(c);google.maps.event.addListener(d,"place_changed",function(){var b=this.getPlace();b.address_components&&(a.address_autocomplete=b.address_components[0].short_name+" "+b.address_components[1].short_name+" "+b.address_components[2].short_name)})}},a.initializeAutocomplete("city"),a.Math=Math;var i=new Date,j=i.getHours(),k=i.getMinutes();a.heure_actuelle=j.toString()+"h",a.minute_actuelle=k.toString()+"min",document.addEventListener("deviceready",function(){function a(){"undefined"!=typeof analytics?(e.startTrackerWithId("UA-59584237-1"),e.trackView("Prévision Météo")):setTimeout(function(){a()},250)}a()},!1)});